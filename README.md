<a id="top"></a>
```
     ███╗   ██╗███████╗████████╗███████╗ ██████╗ █████╗ ███╗   ██╗      ⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⡈⠙⠻⣿⣿⡇⢸⣿⡿⠋⢰⣿⣿⠿⠛⢀⣾⣿⣿⣿⣿⣿⡿⣿⣿⣿⣿⣿⠿⠛⠛⠋⢭⣽⣿
     ████╗  ██║██╔════╝╚══██╔══╝██╔════╝██╔════╝██╔══██╗████╗  ██║      ⣿⣿⣿⣿⣿⣿⣿⣿⣍⠻⢿⣿⣿⣿⠿⠋⠀⠀⠀⠀⠀⠀⣸⡄⠀⠀⠀⠀⠈⠛⠛⠛⢉⠴⠿⠛⠛⠋⠉⠉⠀⠀⠀⢠⣿⣿⣿⣿⣿⣿
     ██╔██╗ ██║█████╗     ██║   ███████╗██║     ███████║██╔██╗ ██║      ⣿⣿⣿⣿⣿⣿⣿⣿⣿⣦⡑⠀⠁⠀⡀⠀⠀⠀⠀⠀⠀⢀⣾⣧⠀⠀⠀⠀⠀⠀⢰⣶⣦⣤⣄⣀⡀⠀⠀⠀⠀⣀⣼⣿⣿⣿⣿⣿⣿⣿
     ██║╚██╗██║██╔══╝     ██║   ╚════██║██║     ██╔══██║██║╚██╗██║      ⣿⣿⣿⣿⣿⣿⣿⣿⠟⠁⣠⣶⣿⣿⡇⠀⠀⠀⠀⠒⠻⢭⣿⣿⡯⠝⠃⠀⠀⠀⢰⣿⣿⣿⣿⣿⣿⣿⣿⡟⠀⢲⣾⣿⢿⣿⣿⣿⣿⣿
     ██║ ╚████║███████╗   ██║   ███████║╚██████╗██║  ██║██║ ╚████║      ⣿⣿⣿⣿⣿⣿⣿⢡⣴⣾⣿⣿⣿⣿⣿⡀⠀⠀⠀⠀⠀⠀⢻⣧⠀⠀⠀⠀⠀⠀⢸⣿⣿⣿⣿⣿⣿⣿⡟⠀⣸⣿⣿⣿⠃⣸⣿⣿⣿⣿
     ╚═╝  ╚═══╝╚══════╝   ╚═╝   ╚══════╝ ╚═════╝╚═╝  ╚═╝╚═╝  ╚═══╝      ⣿⣿⣿⣿⣿⣿⣿⠛⣿⣿⣿⣿⣿⣿⣿⣿⣦⣀⡀⠀⠀⠀⠉⡇⠀⠀⠀⣀⣤⣿⣿⣿⣿⣿⣿⠏⠹⠫⠠⠄⠙⢻⣿⡏⣸⣿⣿⣿⣿⣿
                                                                        ⣿⣿⣿⣿⣿⣿⣿⣷⣄⠀⠈⢻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠿⢿⣿⣿⣿⡿⠿⠛⠁⠀⢀⣥⣾⣶⡂⡀⢱⣼⣿⣿⣿⣿⣿⣿
                                                                         ⣿⣿⣿⣿⣿⣿⣿⣿⣿⣟⢿⣿⣷⣾⣿⠉⠉⠙⠋⠉⠉⠁⠀⠂⠈⠈⢉⠀⠀⡠⣀⣥⣶⣬⠀⢹⣿⣿⠟⢩⣾⣸⣿⣿⣿⣿⣿⣿⣿⣿
```

**Enhanced Cross-Platform Network Discovery & Device Profiling Tool**

[![Windows](https://img.shields.io/badge/Windows-0078D4?style=flat&logo=windows&logoColor=white)](#windows)
[![macOS](https://img.shields.io/badge/macOS-000000?style=flat&logo=apple&logoColor=white)](#macos)
[![Linux](https://img.shields.io/badge/Linux-FCC624?style=flat&logo=linux&logoColor=black)](#linux)

## Enhanced Features

▸ **Advanced Network Discovery** - Multi-technique device detection using ARP, ping, and nmap  
▸ **Comprehensive Device Profiling** - Deep system analysis with OS, services, and user details  
▸ **Service Enumeration & Monitoring** - Real-time service discovery and status tracking  
▸ **Shared Resource Detection** - Identify network shares, printers, and accessible resources  
▸ **Multi-Protocol Authentication** - SSH/WinRM credential-based device access  
▸ **Cross-Platform Consistency** - Unified interface and features across all platforms  
▸ **Enhanced Security Analysis** - MAC vendor identification and device accessibility assessment  
▸ **Detailed JSON Profiling** - Persistent device profiles with historical tracking  
▸ **Flexible Scanning Modes** - Choose between comprehensive, balanced, or fast scanning  
▸ **Real-time Status Reporting** - Live progress updates and detailed summary displays  

## Scanning Modes

### ■ **Comprehensive Mode** (Maximum Discovery)
- [+] Full ARP table analysis and ping sweep (1-254 range)
- [+] Nmap verification with multiple detection techniques
- [+] Deep service enumeration and shared resource discovery
- [+] Complete device profiling with authentication
- [+] Historical tracking and persistent JSON profiles
- [+] MAC vendor lookup with OUI database fallback

### ▲ **Standard Mode** (Balanced Performance)
- [+] ARP table analysis with targeted ping sweep
- [+] Basic nmap verification for active hosts
- [+] Essential service discovery and device profiling
- [-] Limited authentication attempts (preserves performance)
- [+] Basic JSON profiles with core information

### ▪ **Fast Mode** (Quick Discovery)
- [+] ARP table scanning only (fastest results)
- [-] No nmap verification (relies on ARP/ping responses)
- [-] Basic device information only
- [-] No authentication attempts or deep profiling
- [+] Minimal JSON profiles for discovered devices

---

## ◆ Windows <a id="windows"></a>[![Windows](https://img.shields.io/badge/Windows-0078D4?style=flat&logo=windows&logoColor=white)](#top)

### Prerequisites
▪ Windows 10/11 or Windows Server 2016+  
▪ Python 3.8+ ([Download Python](https://www.python.org/downloads/windows/))  
▪ Administrator privileges (for nmap functionality)  
▪ PowerShell 5.1+ (included with Windows)  

### Installation
```powershell
# Clone repository
git clone https://github.com/yynka/netscan.git
cd netscan

# Setup virtual environment (create your own virtual environment locally - they are not included in the repository)
python -m venv ns
.\ns\Scripts\Activate.ps1

# Install Python dependencies
pip install -r requirements.txt

# Verify nmap installation (auto-downloaded with python-nmap)
nmap --version
```

### Usage
```powershell
# Comprehensive network discovery (default mode)
python windows.py

# Authenticated scan with credentials
python windows.py --username admin --password secret --summary

# Fast discovery mode
python windows.py --fast

# Custom authentication ports
python windows.py --ssh-port 2222 --winrm-port 5986

# Debug mode with detailed logging
python windows.py --debug --log-path C:\netscan\logs
```

### Advanced Windows Features
```powershell
# Advanced Windows-specific capabilities
python windows.py --username domain\admin --password secret --summary --debug
# Features: WinRM (5985/5986), SSH fallback, Windows service enumeration
# Discovers: Active Directory details, Windows shares, running services
# Profiles: Computer names, OS versions, last logged users, network adapters
```

※ **Note:** Requires running as Administrator for comprehensive network scanning and WinRM access

---

## ◆ macOS <a id="macos"></a>[![macOS](https://img.shields.io/badge/macOS-000000?style=flat&logo=apple&logoColor=white)](#top)

### Prerequisites
▪ macOS 10.14+ (Mojave or later)  
▪ Homebrew package manager ([Install Homebrew](https://brew.sh))  
▪ Administrator privileges (`sudo` access)  
▪ Command Line Tools for Xcode  

### Installation
```bash
# Clone repository
git clone https://github.com/yynka/netscan.git
cd netscan

# Install system dependencies
brew install nmap python3

# Setup virtual environment (create your own virtual environment locally - they are not included in the repository)
python3 -m venv ns
source ns/bin/activate

# Install Python dependencies
pip3 install -r requirements.txt

# Install Xcode Command Line Tools (if needed)
xcode-select --install
```

### Usage
```bash
# Comprehensive network discovery (default mode)
sudo python3 macos.py

# Authenticated scan with SSH credentials
sudo python3 macos.py --username admin --password secret --summary

# Fast discovery mode
sudo python3 macos.py --fast

# Custom SSH port and logging
sudo python3 macos.py --ssh-port 2222 --log-path /var/log/netscan

# Debug mode with verbose output
sudo python3 macos.py --debug --summary
```

### Advanced macOS Features
```bash
# Advanced macOS-specific capabilities using SSH
sudo python3 macos.py --username admin --password secret --summary --debug
# Features: SSH authentication, macOS service discovery, AFP/SMB share enumeration
# Discovers: macOS version details, running daemons, shared folders, AirDrop settings
# Profiles: Computer names, user accounts, network interfaces, system services
```

※ **Note:** Requires running with `sudo` for network interface access and comprehensive scanning

---

## ◆ Linux <a id="linux"></a>[![Linux](https://img.shields.io/badge/Linux-FCC624?style=flat&logo=linux&logoColor=black)](#top)

### Prerequisites
▪ Linux distribution with Python 3.8+ support  
▪ `sudo` privileges for network operations  
▪ Package manager (apt/yum/dnf/pacman)  
▪ Network utilities (typically pre-installed)  

### Installation
```bash
# Clone repository
git clone https://github.com/yynka/netscan.git
cd netscan

# Install system dependencies (Ubuntu/Debian)
sudo apt-get update
sudo apt-get install -y python3 python3-venv python3-pip nmap curl net-tools

# Install system dependencies (CentOS/RHEL/Fedora)
sudo yum install -y python3 python3-pip nmap curl net-tools
# or: sudo dnf install -y python3 python3-pip nmap curl net-tools

# Setup virtual environment (create your own virtual environment locally - they are not included in the repository)
python3 -m venv ns
source ns/bin/activate

# Install Python dependencies
pip install -r requirements.txt
```

### Usage
```bash
# Comprehensive network discovery (default mode)
sudo python3 linux.py

# Authenticated scan with SSH credentials
sudo python3 linux.py --username admin --password secret --summary

# Fast discovery mode
sudo python3 linux.py --fast

# Custom ports and logging directory
sudo python3 linux.py --ssh-port 2222 --log-path /var/log/netscan

# Debug mode with comprehensive logging
sudo python3 linux.py --debug --summary
```

### Advanced Linux Features
```bash
# Advanced Linux-specific capabilities using SSH and systemctl
sudo python3 linux.py --username admin --password secret --summary --debug
# Features: SSH authentication, systemd service discovery, Samba share enumeration
# Discovers: Distribution details, systemctl services, mounted filesystems, network config
# Profiles: Hostnames, user accounts, running services, shared directories, system info
```

※ **Note:** Requires running with `sudo` for network scanning privileges and comprehensive device access

---

## ※ Enhanced Command Reference

### Universal Commands
All platforms support the same enhanced command structure:

| Command | Description | Default |
|---------|-------------|---------|
| `--summary` | Display detailed device summary after scan | Disabled |
| `--fast` | Fast scan mode (ARP-only, minimal profiling) | Disabled |
| `--debug` | Enable debug logging for troubleshooting | Disabled |
| `--log-path PATH` | Custom log directory for device profiles | `./logs` |
| `--username USER` | Authentication username for device access | None |
| `--password PASS` | Authentication password for device access | None |
| `--ssh-port N` | SSH port number for authentication | `22` |
| `--winrm-port N` | WinRM port number (Windows only) | `5985` |

### Scanning Mode Comparison
| Mode | Discovery Method | Authentication | Profiling | Speed | Use Case |
|------|------------------|----------------|-----------|-------|----------|
| **Comprehensive** | ARP + Ping + Nmap | [+] Full | [+] Deep | Slow | Security audits |
| **Standard** | ARP + Ping + Basic Nmap | [+] Limited | [+] Standard | Medium | Regular monitoring |
| **Fast** | ARP Only | [-] Disabled | [-] Basic | Fast | Quick discovery |

### Platform Command Formats
| Platform | Command Format | Primary Authentication | Secondary Method |
|----------|----------------|----------------------|------------------|
| **Windows** | `python windows.py [options]` | WinRM (5985/5986) | SSH fallback |
| **macOS** | `sudo python3 macos.py [options]` | SSH (22) | None |
| **Linux** | `sudo python3 linux.py [options]` | SSH (22) | None |

## Usage Examples

### Basic Network Discovery
```bash
# Simple network scan (all platforms use comprehensive mode by default)
# Windows
python windows.py

# macOS  
sudo python3 macos.py

# Linux
sudo python3 linux.py
```

### Advanced Authenticated Scanning
```bash
# Comprehensive scan with authentication and detailed reporting
# Windows (WinRM preferred, SSH fallback)
python windows.py --username domain\admin --password P@ssw0rd --summary --debug

# macOS (SSH authentication)
sudo python3 macos.py --username admin --password secret --summary --debug

# Linux (SSH authentication with systemd integration)
sudo python3 linux.py --username root --password toor --summary --debug
```

### Performance Optimized Scanning
```bash
# Fast scan for quick network mapping
# Windows
python windows.py --fast --log-path C:\temp\netscan

# macOS
sudo python3 macos.py --fast --log-path /tmp/netscan

# Linux  
sudo python3 linux.py --fast --log-path /tmp/netscan
```

### Custom Port and Authentication
```bash
# Scan with custom SSH/WinRM ports
# Windows (custom WinRM port)
python windows.py --winrm-port 5986 --ssh-port 2222 --username admin

# macOS (custom SSH port)
sudo python3 macos.py --ssh-port 2222 --username admin --password secret

# Linux (custom SSH port with specific logging)
sudo python3 linux.py --ssh-port 2222 --log-path /var/log/netscan --debug
```

## Technical Implementation

### Windows (Python + WinRM + SSH)
▪ **Technology:** Windows Remote Management (WinRM) with SSH fallback  
▪ **Method:** ARP parsing, ICMP ping sweep, nmap verification with multiple techniques  
▪ **Authentication:** WinRM (5985/5986) preferred, SSH (22) fallback, domain support  
▪ **Services:** Windows services via `sc query`, shared resources via `net share`  
▪ **Profiling:** Computer names, OS versions, user sessions, network adapters  

### macOS (Python + SSH + System Tools)
▪ **Technology:** SSH authentication with native macOS utilities integration  
▪ **Method:** ARP table parsing (`arp -a`), ping sweep, nmap verification  
▪ **Authentication:** SSH connections with public key and password support  
▪ **Services:** macOS daemons via `launchctl`, AFP/SMB shares via `sharing -l`  
▪ **Profiling:** System version, user accounts, network interfaces, running processes  

### Linux (Python + SSH + systemd)
▪ **Technology:** SSH authentication with systemd and network utilities  
▪ **Method:** IP neighbor table parsing, ping sweep, nmap comprehensive scanning  
▪ **Authentication:** SSH connections with key-based and password authentication  
▪ **Services:** systemd services via `systemctl`, Samba shares via `smbclient`  
▪ **Profiling:** Distribution info, running services, mounted filesystems, network config  

## Enhanced Security Benefits

▸ **Comprehensive Network Visibility** - Multi-layer discovery techniques for complete network mapping  
▸ **Device Accessibility Assessment** - Identify which devices allow remote access and management  
▸ **Service Security Analysis** - Monitor running services and potential security vulnerabilities  
▸ **Authentication Testing** - Validate credential access across different platforms and protocols  
▸ **Historical Device Tracking** - Persistent profiles track device changes over time  
▸ **MAC Vendor Intelligence** - Identify device manufacturers and potential security implications  
▸ **Network Inventory Management** - Generate comprehensive reports for compliance and auditing  
▸ **Unauthorized Device Detection** - Identify rogue or unknown devices on the network  

## Output Examples

### Comprehensive Scan Results
```
=== Enhanced Network Scanner ===
[*] Initializing comprehensive network discovery...
[*] Checking network connectivity...
[+] Using interface en0 (192.168.1.100/24)
[*] Starting network scan on 192.168.1.100/24
[*] This may take a few moments...

[*] Running ARP table analysis...
[+] Found device in ARP: 192.168.1.1
[+] Found device in ARP: 192.168.1.152
[+] Found device in ARP: 192.168.1.215

[*] Performing ping sweep...
[*] Scanning... (50/254)
[*] Scanning... (100/254)
[*] Scanning... (150/254)
[*] Scanning... (200/254)
[*] Scanning... (254/254)

[+] Found active host: 192.168.1.1 (hostname: router.local)
[+] Found active host: 192.168.1.152 (hostname: macbook.local)
[+] Found active host: 192.168.1.215 (hostname: iphone.local)

[*] Verifying 3 discovered devices with nmap...
[*] Note: Some devices may not respond to nmap but are still active

[+] Found 3 active devices

[*] Profiling discovered devices...
[*] Profiling device: 192.168.1.1
[+] Platform detected: Unknown
[+] Accessibility: No
[+] Vendor: Cisco Systems, Inc.

[*] Profiling device: 192.168.1.152
[+] Platform detected: macOS
[+] Accessibility: Yes
[+] Vendor: Apple, Inc.

[*] Profiling device: 192.168.1.215
[+] Platform detected: Unknown
[+] Accessibility: No
[+] Vendor: Apple, Inc.

[+] Scan complete! Found 3 devices.
[+] Detailed profiles saved to: /Users/user/netscan/logs
[+] Use --summary flag to see detailed device information

[+] Platform breakdown:
    Unknown: 2 devices
    macOS: 1 devices
[+] Accessible devices: 1/3
```

### Enhanced Device Summary Output
```
================================================================================
ENHANCED DEVICE DISCOVERY SUMMARY
================================================================================

[1] Device: 192.168.1.1
    Hostname: router.local
    Computer Name: N/A
    Platform: Unknown
    OS Version: N/A
    MAC Address: 00:10:18:XX:XX:XX
    Vendor: Cisco Systems, Inc.
    Accessible: No
    Last User: N/A
    Services: 0 found
    Shared Resources: 0 found
    First Seen: 2024-01-15T10:30:00.000000
    Last Seen: 2024-01-15T10:35:00.000000

[2] Device: 192.168.1.152
    Hostname: macbook.local
    Computer Name: MacBook-Pro
    Platform: macOS
    OS Version: macOS 14.2.1 (23C64)
    MAC Address: 3C:06:30:XX:XX:XX
    Vendor: Apple, Inc.
    Accessible: Yes
    Last User: admin
    Services: 15 found
    Shared Resources: 3 found
    First Seen: 2024-01-15T10:30:00.000000
    Last Seen: 2024-01-15T10:35:00.000000
    Top Services:
      - ssh (Running)
      - AppleFileServer (Running)
      - mDNSResponder (Running)
      ... and 12 more
    Shared Resources:
      - Public (/Users/Shared)
      - AirDrop (/Users/admin/AirDrop)
      ... and 1 more

[3] Device: 192.168.1.215
    Hostname: iphone.local
    Computer Name: N/A
    Platform: Unknown
    OS Version: N/A
    MAC Address: 8C:85:90:XX:XX:XX
    Vendor: Apple, Inc.
    Accessible: No
    Last User: N/A
    Services: 0 found
    Shared Resources: 0 found
    First Seen: 2024-01-15T10:30:00.000000
    Last Seen: 2024-01-15T10:35:00.000000

================================================================================
SCAN STATISTICS
================================================================================
Total Devices Discovered: 3
Accessible Devices: 1 (33.3%)
Platform Distribution:
  - macOS: 1 device (33.3%)
  - Unknown: 2 devices (66.7%)
Vendor Distribution:
  - Apple, Inc.: 2 devices (66.7%)
  - Cisco Systems, Inc.: 1 device (33.3%)
Authentication Success Rate: 1/1 (100.0%)
Scan Duration: 45.2 seconds
```

### Fast Mode Output
```
=== Enhanced Network Scanner (Fast Mode) ===
[*] Initializing fast network discovery...
[*] Fast mode enabled - using ARP table only
[*] Checking network connectivity...
[+] Using interface en0 (192.168.1.100/24)

[*] Running ARP table analysis...
[+] Found device in ARP: 192.168.1.1 (router.local)
[+] Found device in ARP: 192.168.1.152 (macbook.local)
[+] Found device in ARP: 192.168.1.215 (iphone.local)

[*] Basic profiling discovered devices...
[*] Profiling device: 192.168.1.1
[+] Platform detected: Unknown
[+] Vendor: Cisco Systems, Inc.

[+] Scan complete! Found 3 devices.
[+] Detailed profiles saved to: /Users/user/netscan/logs
[+] Fast mode completed in 8.3 seconds

[+] Platform breakdown:
    Unknown: 3 devices
[+] Accessible devices: 0/3 (authentication disabled in fast mode)
```

## Dependencies

| Package | Purpose | Version | Platform Support |
|---------|---------|---------|------------------|
| **netifaces** | Network interface enumeration | ≥0.11.0 | Windows, macOS, Linux |
| **python-nmap** | Network scanning capabilities | ≥0.7.1 | Windows, macOS, Linux |
| **psutil** | System and process monitoring | ≥5.9.0 | Windows, macOS, Linux |
| **paramiko** | SSH client connections | ≥3.0.0 | Windows, macOS, Linux |
| **pywinrm** | Windows Remote Management | ≥0.4.3 | Windows only |
| **requests** | HTTP requests for OUI lookup | ≥2.28.0 | Windows, macOS, Linux |

### Optional Dependencies
| Package | Purpose | Installation |
|---------|---------|--------------|
| **nmap** | Enhanced network scanning | `brew install nmap` (macOS), `apt install nmap` (Linux) |
| **curl** | Network utilities and testing | Usually pre-installed |
| **net-tools** | Linux network utilities | `apt install net-tools` (Linux) |

---

## License

[MIT License](LICENSE) - Feel free to use and modify as needed.

**※ Enhanced Security Note:** This tool provides enterprise-grade network discovery and device profiling capabilities. Requires administrative privileges on all platforms for comprehensive scanning. Use responsibly and in compliance with your organization's security policies and local regulations. Always obtain proper authorization before scanning networks you do not own or manage.